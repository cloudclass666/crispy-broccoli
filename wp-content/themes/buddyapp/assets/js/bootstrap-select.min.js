!function(w){var a=function(t,e,i){i&&(i.stopPropagation(),i.preventDefault()),this.$element=w(t),this.$newElement=null,this.button=null,this.options=w.extend({},w.fn.selectpicker.defaults,this.$element.data(),"object"==typeof e&&e),null==this.options.title&&(this.options.title=this.$element.attr("title")),this.val=a.prototype.val,this.render=a.prototype.render,this.init()};a.prototype={constructor:a,init:function(t){var e=this;this.$element.hide(),this.multiple=this.$element.prop("multiple");var i=void 0!==this.$element.attr("class")?this.$element.attr("class").split(/\s+/):"",n=this.$element.attr("id");this.$element.after(this.createView()),this.$newElement=this.$element.next(".select");var s=this.$newElement,l=this.$newElement.find(".dropdown-menu"),o=this.$newElement.find(".dropdown-arrow"),d=(l.find("li > a"),s.addClass("open").find(".dropdown-menu li > a").outerHeight());s.removeClass("open");var a=l.find("li .divider").outerHeight(!0),r=this.$newElement.offset().top,h=0,p=this.$newElement.outerHeight();this.button=this.$newElement.find("> button"),void 0!==n&&(this.button.attr("id",n),w('label[for="'+n+'"]').click(function(){s.find("button#"+n).focus()}));for(var c=0;c<i.length;c++)"selectpicker"!=i[c]&&this.$newElement.addClass(i[c]);this.multiple&&this.$newElement.addClass("select-multiple"),this.button.addClass(this.options.style),l.addClass(this.options.menuStyle),o.addClass(function(){if(e.options.menuStyle)return e.options.menuStyle.replace("dropdown-","dropdown-arrow-")}),this.checkDisabled(),this.checkTabIndex(),this.clickListener();var u=parseInt(l.css("padding-top"))+parseInt(l.css("padding-bottom"))+parseInt(l.css("border-top-width"))+parseInt(l.css("border-bottom-width"));if("auto"==this.options.size){function f(){var t=r-w(window).scrollTop(),e=window.innerHeight,i=u+parseInt(l.css("margin-top"))+parseInt(l.css("margin-bottom"))+2;h=e-t-p-i,s.hasClass("dropup")&&(h=t-i),l.css({"max-height":h+"px","overflow-y":"auto","min-height":3*d+"px"})}f(),w(window).resize(f),w(window).scroll(f),this.$element.bind("DOMNodeInserted",f)}else if(this.options.size&&"auto"!=this.options.size&&l.find("li").length>this.options.size){var m=l.find("li > *").filter(":not(.divider)").slice(0,this.options.size).last().parent().index(),v=l.find("li").slice(0,m+1).find(".divider").length;h=d*this.options.size+v*a+u,l.css({"max-height":h+"px","overflow-y":"scroll"})}this.$element.bind("DOMNodeInserted",w.proxy(this.reloadLi,this)),this.render()},createDropdown:function(){return w("<div class='btn-group select'><i class='dropdown-arrow'></i><button class='btn dropdown-toggle clearfix' data-toggle='dropdown'><span class='filter-option pull-left'></span>&nbsp;<span class='caret'></span></button><ul class='dropdown-menu' role='menu'></ul></div>")},createView:function(){var t=this.createDropdown(),e=this.createLi();return t.find("ul").append(e),t},reloadLi:function(){this.destroyLi(),$li=this.createLi(),this.$newElement.find("ul").append($li),this.render()},destroyLi:function(){this.$newElement.find("li").remove()},createLi:function(){var s=this,t=[],l=[],e="";if(this.$element.find("option").each(function(){t.push(w(this).text())}),this.$element.find("option").each(function(t){var e=void 0!==w(this).attr("class")?w(this).attr("class"):"",i=w(this).text();if(i+=void 0!==w(this).data("subtext")?'<small class="muted">'+w(this).data("subtext")+"</small>":"",w(this).parent().is("optgroup")&&1!=w(this).data("divider"))if(0==w(this).index()){var n=w(this).parent().attr("label");n+=void 0!==w(this).parent().data("subtext")?'<small class="muted">'+w(this).parent().data("subtext")+"</small>":"",0!=w(this)[0].index?l.push('<div class="divider"></div><dt>'+n+"</dt>"+s.createA(i,"opt "+e)):l.push("<dt>"+n+"</dt>"+s.createA(i,"opt "+e))}else l.push(s.createA(i,"opt "+e));else 1==w(this).data("divider")?l.push('<div class="divider"></div>'):l.push(s.createA(i,e))}),0<t.length)for(var i=0;i<t.length;i++){this.$element.find("option").eq(i);e+="<li rel="+i+">"+l[i]+"</li>"}return 0!=this.$element.find("option:selected").length||s.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),w(e)},createA:function(t,e){return'<a tabindex="-1" href="#" class="'+e+'"><span class="pull-left">'+t+"</span></a>"},render:function(){var e=this;if("auto"==this.options.width){var t=this.$newElement.find(".dropdown-menu").css("width");this.$newElement.css("width",t)}else this.options.width&&"auto"!=this.options.width&&this.$newElement.css("width",this.options.width);this.$element.find("option").each(function(t){e.setDisabled(t,w(this).is(":disabled")||w(this).parent().is(":disabled")),e.setSelected(t,w(this).is(":selected"))});var i=this.$element.find("option:selected").map(function(t,e){return null!=w(this).attr("title")?w(this).attr("title"):w(this).text()}).toArray(),n=i.join(", ");if(e.multiple&&-1<e.options.selectedTextFormat.indexOf("count")){var s=e.options.selectedTextFormat.split(">");(1<s.length&&i.length>s[1]||1==s.length&&2<=i.length)&&(n=i.length+" of "+this.$element.find("option").length+" selected")}n=n||(null!=e.options.title?e.options.title:e.options.noneSelectedText),this.$element.next(".select").find(".filter-option").html(n)},setSelected:function(t,e){e?this.$newElement.find("li").eq(t).addClass("selected"):this.$newElement.find("li").eq(t).removeClass("selected")},setDisabled:function(t,e){e?this.$newElement.find("li").eq(t).addClass("disabled"):this.$newElement.find("li").eq(t).removeClass("disabled")},checkDisabled:function(){this.$element.is(":disabled")&&(this.button.addClass("disabled"),this.button.click(function(t){t.preventDefault()}))},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var t=this.$element.attr("tabindex");this.button.attr("tabindex",t)}},clickListener:function(){var s=this;w("body").on("touchstart.dropdown",".dropdown-menu",function(t){t.stopPropagation()}),this.$newElement.on("click","li a",function(t){var e=w(this).parent().index(),i=w(this).parent(),n=i.parents(".select");if(s.multiple&&t.stopPropagation(),t.preventDefault(),n.prev("select").not(":disabled")&&!w(this).parent().hasClass("disabled")){if(s.multiple)n.prev("select").find("option").eq(e).prop("selected")?n.prev("select").find("option").eq(e).removeAttr("selected"):n.prev("select").find("option").eq(e).prop("selected",!0).attr("selected","selected");else n.prev("select").find("option").removeAttr("selected"),n.prev("select").find("option").eq(e).prop("selected",!0).attr("selected","selected");n.find(".filter-option").html(i.text()),n.find("button").focus(),n.prev("select").trigger("change")}}),this.$newElement.on("click","li.disabled a, li dt, li .divider",function(t){t.preventDefault(),t.stopPropagation(),$select=w(this).parent().parents(".select"),$select.find("button").focus()}),this.$element.on("change",function(t){s.render()})},val:function(t){return null!=t?(this.$element.val(t),this.$element.trigger("change"),this.$element):this.$element.val()}},w.fn.selectpicker=function(s,l){var o,d=arguments,t=this.each(function(){var t=w(this),e=t.data("selectpicker"),i="object"==typeof s&&s;if(e)for(var n in s)e[n]=s[n];else t.data("selectpicker",e=new a(this,i,l));"string"==typeof s&&(property=s,o=e[property]instanceof Function?([].shift.apply(d),e[property].apply(e,d)):e[property])});return null!=o?o:t},w.fn.selectpicker.defaults={style:null,size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",width:null,menuStyle:null,toggleSize:null}}(window.jQuery);