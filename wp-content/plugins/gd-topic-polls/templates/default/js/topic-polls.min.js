var gdpol_plugin_edit,gdpol_plugin_form;(function($,d,f,g){gdpol_plugin_form={base:"#gdpol-form-",run:function(b){var c=gdpol_plugin_form.base+b,data=JSON.parse($(".gdpol-poll-settings",$(c)).html());$("form",$(c)).data("gdpol",data);if(data.choice!=="single"&&data.limit>0){$("input[type=checkbox]",$(c)).change(function(){var a=$("input[type=checkbox]:checked",$(c)).length;if(a>=data.limit){$("input[type=checkbox]:not(:checked)").prop("disabled",true)}else{$("input[type=checkbox]").prop("disabled",false)}})}$("form",$(c)).submit(function(){var a=false;if($("button",$(c)).length===1){if(data.choice==="single"){if($("input[type=radio]:checked",$(c)).length===1){a=true}}else{if($("input[type=checkbox]:checked",$(c)).length>0){a=true}}}return a})}};gdpol_plugin_edit={id:1,seq:1,tpl:"",run:function(a,b){gdpol_plugin_edit.seq=a;gdpol_plugin_edit.id=b;gdpol_plugin_edit.controls();gdpol_plugin_edit.responses();gdpol_plugin_edit.validate()},controls:function(){$(f).on("change",".gdpol-field-extra-select",function(){var a=$(this).data("field"),val=$(this).val();$("."+a+"-field:not(."+a+'-'+val).slideUp("fast");$("."+a+'-'+val).slideDown("slow")});$(f).on("change",".gdpol-poll-status",function(){var a=$(this).is(":checked");if(a){$(".gdpol-fields-wrapper").slideDown("slow")}else{$(".gdpol-fields-wrapper").slideUp("fast")}})},responses:function(){gdpol_plugin_edit.tpl=$("#gdpol-response-item-template").html();$(f).on("click",".gdpol-responses-list ._minus button",function(e){e.preventDefault();$(this).closest("li").fadeOut("slow",function(){$(this).remove();if($(".gdpol-responses-list li").length<2){gdpol_plugin_edit.add_response()}})});$(f).on("click",".gdpol-responses-list ._down button",function(e){e.preventDefault();var a=$(this).closest("li");a.insertAfter(a.next())});$(f).on("click",".gdpol-responses-list ._up button",function(e){e.preventDefault();var a=$(this).closest("li");a.insertBefore(a.prev())});$(f).on("click",".gdpol-new-response",function(e){e.preventDefault();gdpol_plugin_edit.add_response()})},add_response:function(){gdpol_plugin_edit.id++;gdpol_plugin_edit.seq++;var a="<li>"+gdpol_plugin_edit.tpl+"</li>";a=a.replace(/{{SEQID}}/gi,gdpol_plugin_edit.seq);a=a.replace(/{{RESID}}/gi,gdpol_plugin_edit.id);a=a.replace(/{{RESPONSE}}/gi,"");$(".gdpol-field-responses ul").append(a)},validate:function(){$("#new-post").submit(gdpol_plugin_edit.check)},check:function(){var a=true;if($(".gdpol-poll-status").is(":checked")){if($(".gdpol-poll-question").val()===""){a=false;alert(gdpol_polls_data.error_question)}else{var b=0;$(".gdpol-responses-list ._label input").each(function(){if($(this).val()!==""){b++}});if(b<2){a=false;alert(gdpol_polls_data.error_responses)}}}return a}}})(jQuery,window,document);
